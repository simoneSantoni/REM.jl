<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Model Estimation · REM.jl</title><meta name="title" content="Model Estimation · REM.jl"/><meta property="og:title" content="Model Estimation · REM.jl"/><meta property="twitter:title" content="Model Estimation · REM.jl"/><meta name="description" content="Documentation for REM.jl."/><meta property="og:description" content="Documentation for REM.jl."/><meta property="twitter:description" content="Documentation for REM.jl."/><meta property="og:url" content="https://simoneSantoni.github.io/REM.jl/guide/estimation/"/><meta property="twitter:url" content="https://simoneSantoni.github.io/REM.jl/guide/estimation/"/><link rel="canonical" href="https://simoneSantoni.github.io/REM.jl/guide/estimation/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="REM.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">REM.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../events/">Events and Data</a></li><li><a class="tocitem" href="../statistics/">Statistics</a></li><li class="is-active"><a class="tocitem" href>Model Estimation</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Why-Case-Control-Sampling?"><span>Why Case-Control Sampling?</span></a></li><li><a class="tocitem" href="#Configuring-the-Sampler"><span>Configuring the Sampler</span></a></li><li><a class="tocitem" href="#Generating-Observations"><span>Generating Observations</span></a></li><li><a class="tocitem" href="#Fitting-Models"><span>Fitting Models</span></a></li><li><a class="tocitem" href="#Understanding-Results"><span>Understanding Results</span></a></li><li><a class="tocitem" href="#Interpreting-Coefficients"><span>Interpreting Coefficients</span></a></li><li><a class="tocitem" href="#Computing-Statistics-Without-Sampling"><span>Computing Statistics Without Sampling</span></a></li><li><a class="tocitem" href="#Model-Comparison"><span>Model Comparison</span></a></li><li><a class="tocitem" href="#Convergence-Issues"><span>Convergence Issues</span></a></li><li><a class="tocitem" href="#Advanced-Topics"><span>Advanced Topics</span></a></li><li><a class="tocitem" href="#Best-Practices"><span>Best Practices</span></a></li></ul></li><li><a class="tocitem" href="../decay/">Temporal Decay</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../../api/types/">Types</a></li><li><a class="tocitem" href="../../api/statistics/">Statistics</a></li><li><a class="tocitem" href="../../api/estimation/">Estimation</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Guide</a></li><li class="is-active"><a href>Model Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Model Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/simoneSantoni/REM.jl/blob/main/docs/src/guide/estimation.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Model-Estimation"><a class="docs-heading-anchor" href="#Model-Estimation">Model Estimation</a><a id="Model-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Estimation" title="Permalink"></a></h1><p>REM.jl estimates relational event models using case-control sampling with stratified conditional logistic regression. This approach is equivalent to Cox proportional hazards for survival data and enables efficient estimation even for large networks.</p><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>The estimation process follows three steps:</p><ol><li><strong>Case-Control Sampling</strong>: For each observed event, sample non-events from the risk set</li><li><strong>Statistic Computation</strong>: Calculate statistics for cases and controls</li><li><strong>Maximum Likelihood Estimation</strong>: Fit stratified conditional logistic regression</li></ol><h2 id="Why-Case-Control-Sampling?"><a class="docs-heading-anchor" href="#Why-Case-Control-Sampling?">Why Case-Control Sampling?</a><a id="Why-Case-Control-Sampling?-1"></a><a class="docs-heading-anchor-permalink" href="#Why-Case-Control-Sampling?" title="Permalink"></a></h2><p>For a network with <span>$n$</span> actors, there are <span>$n(n-1)$</span> possible directed dyads at each time point. Computing statistics for all dyads at all time points is often computationally infeasible.</p><p>Case-control sampling solves this by:</p><ul><li>Treating observed events as &quot;cases&quot;</li><li>Sampling a subset of non-events as &quot;controls&quot;</li><li>Using stratified estimation to obtain consistent parameter estimates</li></ul><p>This approach is statistically valid and dramatically reduces computation time.</p><h2 id="Configuring-the-Sampler"><a class="docs-heading-anchor" href="#Configuring-the-Sampler">Configuring the Sampler</a><a id="Configuring-the-Sampler-1"></a><a class="docs-heading-anchor-permalink" href="#Configuring-the-Sampler" title="Permalink"></a></h2><pre><code class="language-julia hljs">sampler = CaseControlSampler(
    n_controls = 100,         # Controls per case
    exclude_self_loops = true, # Exclude s→s from risk set
    seed = 42                  # Random seed for reproducibility
)</code></pre><h3 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h3><table><tr><th style="text-align: right">Parameter</th><th style="text-align: right">Description</th><th style="text-align: right">Default</th></tr><tr><td style="text-align: right"><code>n_controls</code></td><td style="text-align: right">Number of controls sampled per case</td><td style="text-align: right">Required</td></tr><tr><td style="text-align: right"><code>exclude_self_loops</code></td><td style="text-align: right">Whether to exclude self-events</td><td style="text-align: right"><code>true</code></td></tr><tr><td style="text-align: right"><code>seed</code></td><td style="text-align: right">Random seed (nothing = random each time)</td><td style="text-align: right"><code>nothing</code></td></tr></table><h3 id="Choosing-Number-of-Controls"><a class="docs-heading-anchor" href="#Choosing-Number-of-Controls">Choosing Number of Controls</a><a id="Choosing-Number-of-Controls-1"></a><a class="docs-heading-anchor-permalink" href="#Choosing-Number-of-Controls" title="Permalink"></a></h3><p>The number of controls affects estimation accuracy and computation time:</p><table><tr><th style="text-align: right">n_controls</th><th style="text-align: right">Use Case</th></tr><tr><td style="text-align: right">20-50</td><td style="text-align: right">Quick exploratory analysis</td></tr><tr><td style="text-align: right">50-100</td><td style="text-align: right">Standard analysis</td></tr><tr><td style="text-align: right">100-200</td><td style="text-align: right">Final results, publication</td></tr><tr><td style="text-align: right">200+</td><td style="text-align: right">Very precise estimates needed</td></tr></table><p>More controls = more accurate standard errors, but diminishing returns beyond ~100-200.</p><h2 id="Generating-Observations"><a class="docs-heading-anchor" href="#Generating-Observations">Generating Observations</a><a id="Generating-Observations-1"></a><a class="docs-heading-anchor-permalink" href="#Generating-Observations" title="Permalink"></a></h2><pre><code class="language-julia hljs"># Create observations DataFrame
obs = generate_observations(seq, stats, sampler)</code></pre><p>The resulting DataFrame contains:</p><table><tr><th style="text-align: right">Column</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right"><code>event_index</code></td><td style="text-align: right">Index of the focal event in the sequence</td></tr><tr><td style="text-align: right"><code>sender</code></td><td style="text-align: right">Sender ID</td></tr><tr><td style="text-align: right"><code>receiver</code></td><td style="text-align: right">Receiver ID</td></tr><tr><td style="text-align: right"><code>is_event</code></td><td style="text-align: right"><code>true</code> for cases, <code>false</code> for controls</td></tr><tr><td style="text-align: right"><code>stratum</code></td><td style="text-align: right">Stratum ID (groups each case with its controls)</td></tr><tr><td style="text-align: right"><code>&lt;stat_name&gt;</code></td><td style="text-align: right">One column per statistic</td></tr></table><h3 id="Options"><a class="docs-heading-anchor" href="#Options">Options</a><a id="Options-1"></a><a class="docs-heading-anchor-permalink" href="#Options" title="Permalink"></a></h3><pre><code class="language-julia hljs">obs = generate_observations(seq, stats, sampler;
    start_index = 1,           # First event to include
    end_index = length(seq),   # Last event to include
    decay = 0.0,               # Exponential decay rate
    at_risk = nothing          # Custom set of actors at risk
)</code></pre><h3 id="Excluding-Early-Events"><a class="docs-heading-anchor" href="#Excluding-Early-Events">Excluding Early Events</a><a id="Excluding-Early-Events-1"></a><a class="docs-heading-anchor-permalink" href="#Excluding-Early-Events" title="Permalink"></a></h3><p>The first few events may have unreliable statistics (no history):</p><pre><code class="language-julia hljs"># Skip first 5 events
obs = generate_observations(seq, stats, sampler; start_index=6)</code></pre><h3 id="Custom-Risk-Sets"><a class="docs-heading-anchor" href="#Custom-Risk-Sets">Custom Risk Sets</a><a id="Custom-Risk-Sets-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-Risk-Sets" title="Permalink"></a></h3><p>Specify a custom set of actors at risk:</p><pre><code class="language-julia hljs"># Only actors 1-100 can send/receive
at_risk = collect(1:100)
obs = generate_observations(seq, stats, sampler; at_risk=at_risk)</code></pre><h2 id="Fitting-Models"><a class="docs-heading-anchor" href="#Fitting-Models">Fitting Models</a><a id="Fitting-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Fitting-Models" title="Permalink"></a></h2><h3 id="Direct-Fitting-(Recommended)"><a class="docs-heading-anchor" href="#Direct-Fitting-(Recommended)">Direct Fitting (Recommended)</a><a id="Direct-Fitting-(Recommended)-1"></a><a class="docs-heading-anchor-permalink" href="#Direct-Fitting-(Recommended)" title="Permalink"></a></h3><p>The simplest approach combines sampling and fitting:</p><pre><code class="language-julia hljs">result = fit_rem(seq, stats;
    n_controls = 100,
    seed = 42
)</code></pre><h3 id="Two-Stage-Fitting"><a class="docs-heading-anchor" href="#Two-Stage-Fitting">Two-Stage Fitting</a><a id="Two-Stage-Fitting-1"></a><a class="docs-heading-anchor-permalink" href="#Two-Stage-Fitting" title="Permalink"></a></h3><p>For more control over the process:</p><pre><code class="language-julia hljs"># Stage 1: Generate observations
sampler = CaseControlSampler(n_controls=100, seed=42)
obs = generate_observations(seq, stats, sampler)

# Inspect observations if needed
println(&quot;Observations: &quot;, nrow(obs))
println(&quot;Cases: &quot;, sum(obs.is_event))
println(&quot;Controls: &quot;, sum(.!obs.is_event))

# Stage 2: Fit model
stat_names = [name(s) for s in stats]
result = fit_rem(obs, stat_names)</code></pre><h3 id="Fit-Options"><a class="docs-heading-anchor" href="#Fit-Options">Fit Options</a><a id="Fit-Options-1"></a><a class="docs-heading-anchor-permalink" href="#Fit-Options" title="Permalink"></a></h3><pre><code class="language-julia hljs">result = fit_rem(obs, stat_names;
    maxiter = 100,   # Maximum Newton-Raphson iterations
    tol = 1e-8       # Convergence tolerance for log-likelihood
)</code></pre><h2 id="Understanding-Results"><a class="docs-heading-anchor" href="#Understanding-Results">Understanding Results</a><a id="Understanding-Results-1"></a><a class="docs-heading-anchor-permalink" href="#Understanding-Results" title="Permalink"></a></h2><p>The <code>REMResult</code> object contains:</p><table><tr><th style="text-align: right">Field</th><th style="text-align: right">Type</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right"><code>coefficients</code></td><td style="text-align: right"><code>Vector{Float64}</code></td><td style="text-align: right">Estimated coefficients</td></tr><tr><td style="text-align: right"><code>std_errors</code></td><td style="text-align: right"><code>Vector{Float64}</code></td><td style="text-align: right">Standard errors</td></tr><tr><td style="text-align: right"><code>z_values</code></td><td style="text-align: right"><code>Vector{Float64}</code></td><td style="text-align: right">Z-statistics (coef/se)</td></tr><tr><td style="text-align: right"><code>p_values</code></td><td style="text-align: right"><code>Vector{Float64}</code></td><td style="text-align: right">Two-sided p-values</td></tr><tr><td style="text-align: right"><code>stat_names</code></td><td style="text-align: right"><code>Vector{String}</code></td><td style="text-align: right">Names of statistics</td></tr><tr><td style="text-align: right"><code>n_events</code></td><td style="text-align: right"><code>Int</code></td><td style="text-align: right">Number of events (cases)</td></tr><tr><td style="text-align: right"><code>n_observations</code></td><td style="text-align: right"><code>Int</code></td><td style="text-align: right">Total observations</td></tr><tr><td style="text-align: right"><code>log_likelihood</code></td><td style="text-align: right"><code>Float64</code></td><td style="text-align: right">Log-likelihood at convergence</td></tr><tr><td style="text-align: right"><code>converged</code></td><td style="text-align: right"><code>Bool</code></td><td style="text-align: right">Whether optimization converged</td></tr></table><h3 id="Accessor-Functions"><a class="docs-heading-anchor" href="#Accessor-Functions">Accessor Functions</a><a id="Accessor-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Accessor-Functions" title="Permalink"></a></h3><pre><code class="language-julia hljs">coef(result)        # Coefficient vector
stderror(result)    # Standard errors vector
coeftable(result)   # Full results as DataFrame</code></pre><h3 id="Displaying-Results"><a class="docs-heading-anchor" href="#Displaying-Results">Displaying Results</a><a id="Displaying-Results-1"></a><a class="docs-heading-anchor-permalink" href="#Displaying-Results" title="Permalink"></a></h3><pre><code class="language-julia hljs">println(result)</code></pre><p>Output:</p><pre><code class="language-text hljs">Relational Event Model Results
==============================
Events: 100, Observations: 10100
Log-likelihood: -234.5678
Converged: true

Coefficients:
------------------------------------------------------------
Statistic                  Coef    Std.Err          z      P&gt;|z|
------------------------------------------------------------
repetition               0.4523     0.0812     5.5700     0.0000 ***
reciprocity              0.3156     0.0923     3.4200     0.0006 ***
sender_activity          0.0234     0.0156     1.5000     0.1336
receiver_popularity      0.0567     0.0189     3.0000     0.0027 **
------------------------------------------------------------
Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre><h2 id="Interpreting-Coefficients"><a class="docs-heading-anchor" href="#Interpreting-Coefficients">Interpreting Coefficients</a><a id="Interpreting-Coefficients-1"></a><a class="docs-heading-anchor-permalink" href="#Interpreting-Coefficients" title="Permalink"></a></h2><h3 id="Log-Hazard-Ratios"><a class="docs-heading-anchor" href="#Log-Hazard-Ratios">Log-Hazard Ratios</a><a id="Log-Hazard-Ratios-1"></a><a class="docs-heading-anchor-permalink" href="#Log-Hazard-Ratios" title="Permalink"></a></h3><p>Coefficients are log-hazard ratios. A coefficient β means:</p><ul><li><strong>exp(β)</strong> is the multiplicative effect on the event rate</li><li><strong>β &gt; 0</strong> increases the rate</li><li><strong>β &lt; 0</strong> decreases the rate</li></ul><h3 id="Example-Interpretations"><a class="docs-heading-anchor" href="#Example-Interpretations">Example Interpretations</a><a id="Example-Interpretations-1"></a><a class="docs-heading-anchor-permalink" href="#Example-Interpretations" title="Permalink"></a></h3><table><tr><th style="text-align: right">Statistic</th><th style="text-align: right">Coefficient</th><th style="text-align: right">exp(β)</th><th style="text-align: right">Interpretation</th></tr><tr><td style="text-align: right">Repetition</td><td style="text-align: right">0.5</td><td style="text-align: right">1.65</td><td style="text-align: right">Each past s→r event increases rate by 65%</td></tr><tr><td style="text-align: right">Reciprocity</td><td style="text-align: right">0.8</td><td style="text-align: right">2.23</td><td style="text-align: right">Past r→s events double the rate</td></tr><tr><td style="text-align: right">SenderActivity</td><td style="text-align: right">-0.1</td><td style="text-align: right">0.90</td><td style="text-align: right">High-activity senders have 10% lower per-dyad rates</td></tr><tr><td style="text-align: right">TransitiveClosure</td><td style="text-align: right">0.3</td><td style="text-align: right">1.35</td><td style="text-align: right">Each shared partner increases rate by 35%</td></tr><tr><td style="text-align: right">NodeMatch</td><td style="text-align: right">0.4</td><td style="text-align: right">1.49</td><td style="text-align: right">Same-attribute dyads are 49% more likely</td></tr></table><h3 id="Confidence-Intervals"><a class="docs-heading-anchor" href="#Confidence-Intervals">Confidence Intervals</a><a id="Confidence-Intervals-1"></a><a class="docs-heading-anchor-permalink" href="#Confidence-Intervals" title="Permalink"></a></h3><p>Approximate 95% confidence intervals:</p><pre><code class="language-julia hljs">using Distributions

alpha = 0.05
z = quantile(Normal(), 1 - alpha/2)

lower = coef(result) .- z .* stderror(result)
upper = coef(result) .+ z .* stderror(result)

# Hazard ratio confidence intervals
hr_lower = exp.(lower)
hr_upper = exp.(upper)</code></pre><h2 id="Computing-Statistics-Without-Sampling"><a class="docs-heading-anchor" href="#Computing-Statistics-Without-Sampling">Computing Statistics Without Sampling</a><a id="Computing-Statistics-Without-Sampling-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-Statistics-Without-Sampling" title="Permalink"></a></h2><p>To compute statistics for all events (without controls):</p><pre><code class="language-julia hljs">stats_df = compute_statistics(seq, stats; decay=0.0)</code></pre><p>Returns a DataFrame with one row per event:</p><table><tr><th style="text-align: right">Column</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right"><code>sender</code></td><td style="text-align: right">Sender ID</td></tr><tr><td style="text-align: right"><code>receiver</code></td><td style="text-align: right">Receiver ID</td></tr><tr><td style="text-align: right"><code>time</code></td><td style="text-align: right">Event time</td></tr><tr><td style="text-align: right"><code>&lt;stat_name&gt;</code></td><td style="text-align: right">Statistic values</td></tr></table><p><strong>Use case</strong>: Exploratory analysis, visualization, or exporting statistics.</p><h2 id="Model-Comparison"><a class="docs-heading-anchor" href="#Model-Comparison">Model Comparison</a><a id="Model-Comparison-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Comparison" title="Permalink"></a></h2><h3 id="Comparing-Log-Likelihoods"><a class="docs-heading-anchor" href="#Comparing-Log-Likelihoods">Comparing Log-Likelihoods</a><a id="Comparing-Log-Likelihoods-1"></a><a class="docs-heading-anchor-permalink" href="#Comparing-Log-Likelihoods" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Nested models
stats1 = [Repetition(), Reciprocity()]
stats2 = [Repetition(), Reciprocity(), TransitiveClosure()]

result1 = fit_rem(seq, stats1; n_controls=100, seed=42)
result2 = fit_rem(seq, stats2; n_controls=100, seed=42)

println(&quot;Model 1 LL: &quot;, result1.log_likelihood)
println(&quot;Model 2 LL: &quot;, result2.log_likelihood)

# Likelihood ratio test (approximate)
using Distributions
LR = 2 * (result2.log_likelihood - result1.log_likelihood)
df = length(stats2) - length(stats1)
p_value = 1 - cdf(Chisq(df), LR)
println(&quot;LR test p-value: &quot;, p_value)</code></pre><h3 id="Multiple-Seeds"><a class="docs-heading-anchor" href="#Multiple-Seeds">Multiple Seeds</a><a id="Multiple-Seeds-1"></a><a class="docs-heading-anchor-permalink" href="#Multiple-Seeds" title="Permalink"></a></h3><p>For robustness, compare results across different random seeds:</p><pre><code class="language-julia hljs">results = [fit_rem(seq, stats; n_controls=100, seed=s) for s in 1:5]

# Check coefficient stability
for (i, r) in enumerate(results)
    println(&quot;Seed $i: &quot;, round.(coef(r), digits=3))
end</code></pre><h2 id="Convergence-Issues"><a class="docs-heading-anchor" href="#Convergence-Issues">Convergence Issues</a><a id="Convergence-Issues-1"></a><a class="docs-heading-anchor-permalink" href="#Convergence-Issues" title="Permalink"></a></h2><h3 id="Checking-Convergence"><a class="docs-heading-anchor" href="#Checking-Convergence">Checking Convergence</a><a id="Checking-Convergence-1"></a><a class="docs-heading-anchor-permalink" href="#Checking-Convergence" title="Permalink"></a></h3><pre><code class="language-julia hljs">if !result.converged
    @warn &quot;Model did not converge - results may be unreliable&quot;
end</code></pre><h3 id="Common-Causes-and-Solutions"><a class="docs-heading-anchor" href="#Common-Causes-and-Solutions">Common Causes and Solutions</a><a id="Common-Causes-and-Solutions-1"></a><a class="docs-heading-anchor-permalink" href="#Common-Causes-and-Solutions" title="Permalink"></a></h3><table><tr><th style="text-align: right">Issue</th><th style="text-align: right">Symptom</th><th style="text-align: right">Solution</th></tr><tr><td style="text-align: right">Perfect separation</td><td style="text-align: right">Very large coefficients</td><td style="text-align: right">Remove or transform problematic statistic</td></tr><tr><td style="text-align: right">Multicollinearity</td><td style="text-align: right">Large standard errors</td><td style="text-align: right">Remove correlated statistics</td></tr><tr><td style="text-align: right">Sparse data</td><td style="text-align: right">Non-convergence</td><td style="text-align: right">Increase n_controls, simplify model</td></tr><tr><td style="text-align: right">Too many parameters</td><td style="text-align: right">Slow convergence</td><td style="text-align: right">Reduce model complexity</td></tr></table><h3 id="Handling-Non-Convergence"><a class="docs-heading-anchor" href="#Handling-Non-Convergence">Handling Non-Convergence</a><a id="Handling-Non-Convergence-1"></a><a class="docs-heading-anchor-permalink" href="#Handling-Non-Convergence" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Increase iterations
result = fit_rem(seq, stats; n_controls=100, maxiter=500)

# Check for separation
for (i, name) in enumerate(result.stat_names)
    if abs(result.coefficients[i]) &gt; 10
        @warn &quot;Possible separation for $name&quot;
    end
end</code></pre><h2 id="Advanced-Topics"><a class="docs-heading-anchor" href="#Advanced-Topics">Advanced Topics</a><a id="Advanced-Topics-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-Topics" title="Permalink"></a></h2><h3 id="Bootstrapping-Standard-Errors"><a class="docs-heading-anchor" href="#Bootstrapping-Standard-Errors">Bootstrapping Standard Errors</a><a id="Bootstrapping-Standard-Errors-1"></a><a class="docs-heading-anchor-permalink" href="#Bootstrapping-Standard-Errors" title="Permalink"></a></h3><p>For more robust standard errors:</p><pre><code class="language-julia hljs">function bootstrap_rem(seq, stats; n_bootstrap=100, n_controls=100)
    n = length(seq)
    boot_coefs = zeros(n_bootstrap, length(stats))

    for b in 1:n_bootstrap
        # Resample events with replacement
        indices = rand(1:n, n)
        boot_events = [seq[i] for i in sort(indices)]
        boot_seq = EventSequence(boot_events)

        result = fit_rem(boot_seq, stats; n_controls=n_controls, seed=b)
        boot_coefs[b, :] = coef(result)
    end

    # Bootstrap standard errors
    boot_se = vec(std(boot_coefs, dims=1))
    return boot_se
end</code></pre><h3 id="Time-Varying-Effects"><a class="docs-heading-anchor" href="#Time-Varying-Effects">Time-Varying Effects</a><a id="Time-Varying-Effects-1"></a><a class="docs-heading-anchor-permalink" href="#Time-Varying-Effects" title="Permalink"></a></h3><p>Model effects that change over time using event windows:</p><pre><code class="language-julia hljs"># Split sequence into periods
mid_point = length(seq) ÷ 2

# Fit separate models
result_early = fit_rem(seq, stats;
    n_controls=100, start_index=1, end_index=mid_point)
result_late = fit_rem(seq, stats;
    n_controls=100, start_index=mid_point+1)

# Compare coefficients
println(&quot;Early period: &quot;, coef(result_early))
println(&quot;Late period: &quot;, coef(result_late))</code></pre><h2 id="Best-Practices"><a class="docs-heading-anchor" href="#Best-Practices">Best Practices</a><a id="Best-Practices-1"></a><a class="docs-heading-anchor-permalink" href="#Best-Practices" title="Permalink"></a></h2><ol><li><strong>Set random seed</strong>: Always use a seed for reproducibility</li><li><strong>Check convergence</strong>: Verify <code>result.converged == true</code></li><li><strong>Adequate controls</strong>: Use at least 50-100 controls</li><li><strong>Skip early events</strong>: Consider excluding first few events with <code>start_index</code></li><li><strong>Avoid multicollinearity</strong>: Don&#39;t include highly correlated statistics</li><li><strong>Scale large counts</strong>: Use <code>LogDegree</code> for networks with high-degree hubs</li><li><strong>Sufficient events</strong>: Aim for at least 10 events per parameter</li><li><strong>Compare seeds</strong>: Verify stability across different random seeds</li></ol></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../statistics/">« Statistics</a><a class="docs-footer-nextpage" href="../decay/">Temporal Decay »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Tuesday 9 December 2025 12:36">Tuesday 9 December 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
